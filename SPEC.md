# Battle Charge Game Specification

## ゲーム概要 (Game Overview)
「Battle Charge」は、エネルギー管理と読み合いが鍵となるターン制戦略バトルゲームです。
プレイヤーと対戦相手は同時に行動を選択し、その組み合わせによって結果が決まる「同時ターン制」を採用しています。

### 勝利条件 (Win Conditions)
以下のいずれかの条件を満たすと勝利となります。
1.  **敵の撃破**: 相手のHPを0にする。
2.  **エネルギー充填**: 自分のエネルギーを「勝利必要エネルギー (WinE)」まで溜める。

### 基本アクション (Basic Actions)
毎ターン、以下の3つの行動から1つを選択します。

1.  **CHARGE (チャージ)**
    *   **効果**: エネルギーを `ChgE` 分回復する。
    *   **コスト**: `ChgC` (通常は0)。
    *   **弱点**: 無防備になり、攻撃を受けるとダメージを受ける。

2.  **ATTACK (攻撃)**
    *   **効果**: 相手に `ATK` 分のダメージを与える。
    *   **コスト**: `AtkC`。
    *   **相性**:
        *   相手が **CHARGE** -> ダメージ成功。
        *   相手が **ATTACK** -> お互いの `ATK` を比較し、高い方が低い方にダメージ（差分ではなく `ATK` 値そのもの）。同値なら相殺。
        *   相手が **GUARD** -> 防がれ、ダメージ0。

3.  **GUARD (防御)**
    *   **効果**: 相手の攻撃を防ぐ。ダメージを0にする。
    *   **コスト**: `GrdC`。
    *   **弱点**: 相手が **CHARGE** の場合、相手にエネルギーを安全に溜めさせてしまう。

### スキル (Skills)
タワーモード等で習得可能な特殊行動です。
*   **発動条件**: キャラクターがスキルを所持し、かつコスト分のエネルギーがあること。
*   **分類**: 各スキルは `ATTACK`, `CHARGE`, `GUARD`, `SPECIAL` のいずれかの属性を持ち、基本アクションと同様の相性関係が適用されます。

## ゲームモード (Game Modes)
1.  **NORMAL**: 1対1のCPU戦（フリーバトル）。CPUの強さを選択可能。
2.  **TOWER**: 終わりのない塔を登るサバイバルモード。HPや状態を引き継ぎ、徐々に強くなる敵と連戦する。アイテムや新スキルによる強化要素あり。
3.  **ONLINE**: 部屋IDを共有して行うリアルタイム対人戦（P2P通信）。

---


## キャラクターデータ (Characters)
プレイヤーが選択可能なキャラクター一覧です。

| ID | 名前 (Name) | HP | ATK | WinE | ChgE | GrdC | AtkC | StartE | 特徴 (Tagline) | アイコン |
| :--- | :--- | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :--- | :---: |
| NORMAL | Normal | 3 | 1 | 5 | 1 | 0 | 1 | 0 | ノーマルタイプ | user |
| STRIKER | Striker | 2 | 3 | 6 | 1 | 0 | 2 | 1 | 猛撃の処刑人 | zap |
| TACTICIAN | Tactician | 3 | 1 | 12 | 2 | 1 | 1 | 3 | 技巧派軍師 | brain |
| TANK | Tank | 5 | 1 | 8 | 1 | 0 | 1 | 0 | 鉄壁の守護者 | shield |
| ASSASSIN | Assassin | 2 | 1 | 4 | 1 | 0 | 1 | 0 | 電光石火の暗殺者 | target |
| BERSERKER | Berserker | 1 | 6 | 10 | 1 | 0 | 4 | 2 | 全てを破壊する矛 | flame |
| SAGE | Sage | 2 | 1 | 15 | 3 | 1 | 2 | 3 | 身軽な魔導師 | wand-2 |
| REVENGER | Revenger | 3 | 2 | 7 | 1 | 0 | 1 | 0 | 相殺を制するカウンター | swords |
| OVERDRIVE | Overdrive | 2 | 2 | 10 | 1 | 1 | 3 | 6 | オーバークロック | battery-charging |

## タワーモード：敵特性 (Enemy Traits)
タワーモードの通常敵は、基本キャラクターに以下のランダムな特性（接頭辞）が付与されて強化されます。

| 名前 | 効果補正 | 説明 |
| :--- | :--- | :--- |
| 迅雷の | ChgE +1, HP -1 | チャージ速度に特化した軽量型 |
| 鋼鉄の | HP +3, AtkC +1 | 圧倒的な耐久力を持つ重量型 |
| 狂乱の | ATK +2, WinE +2 | 攻撃力は高いが勝利が遠のいた暴走型 |
| 狡猾な | GrdC -1, WinE -1 | 守りが固く、勝利条件も緩い厄介な型 |
| 神速の | StartE +2, HP -2 | 開幕からフルスロットルの短期決戦型 |

> ※ 階層が進むごとに、さらに全てのステータスに補正がかかります。

## ボスキャラクター (Boss Characters)
5階層ごとに出現する強力なボスです。

| ID | 名前 | HP | ATK | WinE | ChgE | GrdC | AtkC | ChgC | StartE | 特徴 |
| :--- | :--- | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :--- |
| VOID_EATER | Void Eater | 15 | 2 | 20 | 4 | 0 | 2 | 1 | 5 | 全てを無に帰すタワーの支配者 |
| CORE_TITAN | Core Titan | 25 | 4 | 15 | 1 | 1 | 3 | 0 | 0 | 一撃必殺のチャージを蓄える巨像 |
| FALLEN_KING | Fallen King | 20 | 3 | 18 | 2 | 1 | 2 | 0 | 2 | かつて栄華を極めた堕落の王 |
| STORM_BRINGER | Storm Bringer | 12 | 2 | 10 | 5 | 0 | 1 | 0 | 4 | 嵐を呼ぶ天空の覇者 |
| ABYSS_WATCHER | Abyss Watcher | 30 | 2 | 12 | 1 | 0 | 2 | 0 | 0 | 深淵を覗き込む異形の存在 |

## 宝箱モンスター (Treasure Monster)
特定の階層で出現する宝箱の擬態です。

| 名前 | HP | ATK | WinE | ChgE | GrdC | AtkC | ChgC | StartE | 特徴 |
| :--- | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :--- |
| Treasure | 1 | 7 | 10 | 1 | 10 | 7 | 0 | 0 | 中にはお宝が詰まっているようだ |

## 敵専用パッシブスキル (Enemy Passive Skills)
タワーモードの敵（宝箱除く）が戦闘開始時に発動するパッシブスキルです。

### 自己強化 (Self Buffs)
| ID | 名前 | 効果 | 説明 |
| :--- | :--- | :--- | :--- |
| FIRST_STRIKE | 機先 | StartE +2 | 開幕エネルギー+2 |
| IRON_CLAD | 堅牢 | DMG_REDUCE (3ターン) | 開幕3ターン軽減(1) |
| WAR_CRY | 雄叫び | ATK_UP (3ターン) | 開幕3ターンATK+1 |
| FOCUS | 集中 | CHGE_UP (3ターン) | 開幕3ターンChgE+1 |
| VITALITY | 活力 | HP +5 | 最大HP+5 |

### プレイヤー妨害 (Player Debuffs)
| ID | 名前 | 効果 | 説明 |
| :--- | :--- | :--- | :--- |
| LIFE_CUT | 命削り | Player HP 30%減 | プレイヤーHPを3割削る |
| SLUGGISH | 停滞 | Player ChgE 30%減 | プレイヤーチャージ量を3割削る |
| LONG_ROAD | 長き道 | Player WinE 1.5倍 | 勝利必要エネルギーが1.5倍になる |
| SILENCE | 沈黙 | SKILL_SEAL (3ターン) | 3ターンの間スキル使用不可 |
| HEAVY_WEIGHT | 重枷 | Player AtkC +1 | 攻撃コストが1増加 |
| LEAK | 漏出 | Player StartE 50%減 | 初期エネルギーを半減 |

## スキル一覧 (Skills)
プレイヤーが習得可能なアクティブスキルです。

| ID | 名前 | コスト | カテゴリ | 効果 |
| :--- | :--- | :---: | :---: | :--- |
| ASSAULT | 強襲 | 2-4 | ATTACK | 敵に ? ダメージ (ガード時自傷) |
| DRAIN | ドレイン | 1-3 | SPECIAL | 相手のエネルギーを ? 減少 |
| JAMMING | 妨害 | 2-4 | SPECIAL | ?ターンの間、敵ChgEを ? 減少 |
| COUNTER | カウンター | 1-3 | GUARD | ガード＆敵攻撃時にATK分反射 |
| CONVERT | 変換 | 0-2 | CHARGE | HP ? 消費してエネルギー ? チャージ |
| BARRIER | バリア | 2-3 | GUARD | ?ターンの間、被ダメージ ? 軽減 |
| POISON | 毒 | 3-5 | SPECIAL | (非ガード時) ?エナジー貯めるたび ?ダメ |
| WEAKEN | 衰弱 | 2-4 | SPECIAL | (攻撃時) ?ターンの間 相手ATK ? ダウン |
| PARALYZE | 麻痺 | 2-4 | SPECIAL | (ガード時) 相手のガードコスト ? アップ |
| PIERCE | ガード貫通 | 1-3 | ATTACK | (ガード時のみ) ? ダメージを与える |
| INSPIRE | 鼓舞 | 2-4 | CHARGE | ?ターンの間、自分のATK ? アップ |
| FOCUS | 集中 | 2-4 | CHARGE | ?ターンの間、自分のChgE ? アップ |
| SHOCK | 衝撃 | 3-5 | ATTACK | 固定1ダメージ (防御無視) |
| HEAL | ヒール | 3-5 | CHARGE | HPを ? 回復 |
| SNATCH | 強奪 | 2-4 | ATTACK | 敵のエネルギーを ? 奪う |
| VAMPIRE | 吸血 | 3-5 | ATTACK | ダメージの ?% を回復 |
| DOOM | 死の宣告 | 3-5 | SPECIAL | ?ターン後に ?ダメージの爆弾を付与 |

## アイテム効果 (Item Effects)
宝箱から入手できる強化・弱体化効果です（メリットとデメリットのセットで適用）。

### メリット (Merits)
*   **ATK_UP**: ATKアップ
*   **HP_UP**: 最大HPアップ
*   **CHGE_UP**: チャージ効率(ChgE)アップ
*   **WINE_DOWN**: 勝利必要E(WinE)ダウン
*   **GRDC_DOWN**: ガードコストダウン
*   **ATKC_DOWN**: 攻撃コストダウン
*   **START_E_UP**: 初期エネルギーアップ
*   **SKILL_EFFECT_UP**: スキル効果量アップ
*   **SKILL_COST_DOWN**: スキルコストダウン
*   **CHARGE_COST_DOWN**: チャージコストダウン

### デメリット (Demerits)
*   **ATK_DOWN**: ATKダウン
*   **HP_DOWN**: 最大HPダウン
*   **CHGE_DOWN**: チャージ効率(ChgE)ダウン
*   **WINE_UP**: 勝利必要E(WinE)アップ
*   **GRDC_UP**: ガードコストアップ
*   **ATKC_UP**: 攻撃コストアップ
*   **START_E_UP**: 初期エネルギーダウン
*   **SKILL_EFFECT_DOWN**: スキル効果量ダウン
*   **SKILL_COST_UP**: スキルコストアップ
*   **CHARGE_COST_UP**: チャージコストアップ

## タワーモード仕様 (Tower Mode Mechanics)

## タワーモード：敵出現システム (Tower Mode Spawn System)
### ダブル・デッキシステム (Double Deck System)
敵の出現に「デッキ（山札）」の概念を導入し、ランダム性を保ちつつも必ず全キャラクターと戦うループを形成します。

1.  **通常敵 (Mob Deck)**
    *   全9種の通常キャラクターが格納されたデッキを使用。
    *   デッキから1体ずつ引かれ、空になるとリシャッフルされます。
    *   これにより、9階層の間に必ず全キャラクターが出現します。
2.  **ボス (Boss Deck)**
    *   全5種のボスキャラクターが格納されたデッキを使用。
    *   5階層ごとのボス戦で1体ずつ引かれ、空になるとリシャッフルされます。
    *   25階層（5種×5階層）ループするまで同じボスとは戦いません。

### 強化と難易度 (Difficulty Scaling)
階層進行に応じて、敵に「特性（Traits）」と「パッシブスキル」が付与され、AIレベルが上昇します。

| 階層 (Floor) | 特性数 (Prefixes) | パッシブスキル (Passive) | AI Level | 備考 |
| :--- | :---: | :---: | :---: | :--- |
| 1 - 4F | 0 | なし | EASY | チュートリアル区間 |
| 6 - 9F | 1 | 自己強化系 (Self Buff) | NORMAL | 本格的な戦闘開始 |
| 11 - 14F | 1 | プレイヤー妨害系 (Debuff) | NORMAL | いやらしい戦術が登場 |
| 16 - 19F | 1 - 2 | ランダム (Any) | HARD | 複数の特性が付く可能性 |
| 20 - 24F | 2 | ランダム (Any) | HARD | 常に2つの特性 |
| 26F - | 2 - 3 | ランダム (Any) | EXPERT | 極限状態 |

※ 5の倍数階（ボス戦）および宝箱階は、このルールから除外されます。

## 詳細ターン進行ロジック (Turn Execution Logic)
ターン処理は以下の厳密な順序で行われます。

1.  **コスト消費 (Cost Consumption)**:
    *   選択したアクションのコスト（Energy）が消費されます。
2.  **スキル発動・即時効果 (Skill Execution)**:
    *   バフ・デバフの付与、HP回復、エネルギー吸収などがこのタイミングで発生します。
    *   カウンター系スキル（WEAKEN, PARALYZE）の条件判定もここで行われます。
3.  **チャージ処理 (Charging)**:
    *   CHARGEアクションを選択した場合、エネルギーが回復します。
    *   **毒 (POISON)**: チャージ量に応じた毒ダメージ判定はこのタイミングです。
4.  **ダメージ計算 (Damage Calculation)**:
    *   お互いのアクションの相性判定。
    *   攻撃系スキル（ASSAULT, PIERCE等）の特殊ダメージ計算。
5.  **ダメージ軽減 (Damage Reduction)**:
    *   バリアやパッシブスキルによる軽減値をダメージから減算します。
6.  **吸血処理 (Vampire)**:
    *   VAMPIREスキル所持時、与えたダメージに応じたHP回復が発生します。
7.  **HP更新 (HP Update)**:
    *   最終的なダメージをHPから減算します。

## 宝箱生成ロジック (Treasure Generation)
*   **通常宝箱**:
    *   「メリット効果」と「デメリット効果」のセットが提示されます。
    *   **衝突回避**: メリットで上昇するステータス（例：ATK）を、デメリットで減少させる（例：ATKダウン）ことがないように、可能な限り異なるパラメータが選ばれます。
*   **ミミック（宝箱モンスター）**:
    *   倒すと必ず「新スキル」をドロップします。
    *   スキルのコストや効果量は、所定の範囲内でランダムに変動したユニークな性能になります。

